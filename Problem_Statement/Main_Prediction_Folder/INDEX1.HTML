<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Churn Analysis Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 20px;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .kpi-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .kpi-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .kpi-label {
            color: #666;
            font-size: 0.9rem;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .chart-card:hover {
            transform: translateY(-2px);
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        .large-chart {
            height: 400px;
        }

        .segment-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .segment-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: #f1f5f9;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .segment-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .insight-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .insight-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insight-list {
            list-style: none;
        }

        .insight-list li {
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .insight-list li:last-child {
            border-bottom: none;
        }

        .risk-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .risk-high {
            background: #fef2f2;
            color: #dc2626;
        }

        .risk-medium {
            background: #fffbeb;
            color: #d97706;
        }

        .risk-low {
            background: #f0fdf4;
            color: #16a34a;
        }

        .recommendation-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .recommendation-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .recommendation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .recommendation-item {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
        }

        .recommendation-item h4 {
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .recommendation-item p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .kpi-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header fade-in">
            <h1>Customer Churn Analysis Dashboard</h1>
            <p>Real-time insights into customer retention patterns and predictive analytics</p>
            <div class="segment-selector">
                <button class="segment-btn active" onclick="setActiveSegment('all')">All Customers</button>
                <button class="segment-btn" onclick="setActiveSegment('high')">High Risk</button>
                <button class="segment-btn" onclick="setActiveSegment('medium')">Medium Risk</button>
                <button class="segment-btn" onclick="setActiveSegment('low')">Low Risk</button>
            </div>
        </div>

        <!-- KPI Cards -->
        <div class="kpi-grid fade-in">
            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white;">üë•</div>
                </div>
                <div class="kpi-value" style="color: #ef4444;">20.4%</div>
                <div class="kpi-label">Overall Churn Rate</div>
            </div>

            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-icon" style="background: linear-gradient(135deg, #10b981, #059669); color: white;">üìä</div>
                </div>
                <div class="kpi-value" style="color: #10b981;">86.6%</div>
                <div class="kpi-label">ANN Model Accuracy</div>
            </div>

            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white;">‚ö°</div>
                </div>
                <div class="kpi-value" style="color: #f59e0b;">32.4%</div>
                <div class="kpi-label">Germany Churn Rate</div>
            </div>

            <div class="kpi-card">
                <div class="kpi-header">
                    <div class="kpi-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white;">üß†</div>
                </div>
                <div class="kpi-value" style="color: #8b5cf6;">2,945</div>
                <div class="kpi-label">ANN Parameters</div>
            </div>
        </div>

        <!-- Charts Grid -->
        <div class="chart-grid fade-in">
            <!-- Churn by Geography -->
            <div class="chart-card">
                <div class="chart-title">üìç Churn Rate by Geography</div>
                <div class="chart-container">
                    <canvas id="geographyChart"></canvas>
                </div>
            </div>

            <!-- Age Distribution -->
            <div class="chart-card">
                <div class="chart-title">üë• Churn by Age Groups</div>
                <div class="chart-container">
                    <canvas id="ageChart"></canvas>
                </div>
            </div>

            <!-- ANN Architecture -->
            <div class="chart-card">
                <div class="chart-title">üß† ANN Model Architecture & Performance</div>
                <div class="chart-container">
                    <canvas id="annChart"></canvas>
                </div>
            </div>

            <!-- Model Performance -->
            <div class="chart-card">
                <div class="chart-title">üìà ANN Training Progress</div>
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>

            <!-- Risk Segmentation -->
            <div class="chart-card">
                <div class="chart-title">üéØ Customer Risk Segmentation</div>
                <div class="chart-container">
                    <canvas id="riskChart"></canvas>
                </div>
            </div>

            <!-- Product Analysis -->
            <div class="chart-card">
                <div class="chart-title">üí≥ Churn by Number of Products</div>
                <div class="chart-container">
                    <canvas id="productChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Insights Grid -->
        <div class="insights-grid fade-in">
            <div class="insight-card">
                <div class="insight-title">
                    üö® High-Risk Indicators
                </div>
                <ul class="insight-list">
                    <li>
                        <span>Age 50-60 years</span>
                        <span class="risk-badge risk-high">High Risk</span>
                    </li>
                    <li>
                        <span>Germany Location</span>
                        <span class="risk-badge risk-high">High Risk</span>
                    </li>
                    <li>
                        <span>Inactive Members</span>
                        <span class="risk-badge risk-high">High Risk</span>
                    </li>
                    <li>
                        <span>Single Product</span>
                        <span class="risk-badge risk-medium">Medium Risk</span>
                    </li>
                </ul>
            </div>

            <div class="insight-card">
                <div class="insight-title">
                    ‚≠ê Retention Factors
                </div>
                <ul class="insight-list">
                    <li>
                        <span>Active Membership</span>
                        <span class="risk-badge risk-low">Protects</span>
                    </li>
                    <li>
                        <span>2 Products</span>
                        <span class="risk-badge risk-low">Optimal</span>
                    </li>
                    <li>
                        <span>France/Spain</span>
                        <span class="risk-badge risk-low">Lower Risk</span>
                    </li>
                    <li>
                        <span>Younger Age</span>
                        <span class="risk-badge risk-low">Stable</span>
                    </li>
                </ul>
            </div>

            <div class="insight-card">
                <div class="insight-title">
                    üìä Key Statistics
                </div>
                <ul class="insight-list">
                    <li>
                        <span>Model Architecture</span>
                        <span class="risk-badge risk-low">3 Layers</span>
                    </li>
                    <li>
                        <span>Total Parameters</span>
                        <span>2,945</span>
                    </li>
                    <li>
                        <span>Training Accuracy</span>
                        <span>87.04%</span>
                    </li>
                    <li>
                        <span>Validation Accuracy</span>
                        <span>86.20%</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="recommendation-card fade-in">
            <div class="recommendation-title">üß† ANN Model Insights & Strategic Recommendations</div>
            <div class="recommendation-grid">
                <div class="recommendation-item">
                    <h4>üî¥ High-Risk Segment (20%)</h4>
                    <p>ANN identifies customers with 45%+ churn probability. Target German customers aged 45-55 with aggressive retention: premium upgrades and relationship managers.</p>
                </div>
                <div class="recommendation-item">
                    <h4>üü° Medium-Risk Segment (60%)</h4>
                    <p>ANN predicts 15-45% churn probability. Implement value-driven communication with personalized messages and loyalty programs to maintain engagement.</p>
                </div>
                <div class="recommendation-item">
                    <h4>üü¢ Low-Risk Segment (20%)</h4>
                    <p>ANN shows <15% churn probability. Continue nurturing these engaged customers with rewards and focus on long-term upselling opportunities.</p>
                </div>
                <div class="recommendation-item">
                    <h4>‚ö° Model Performance</h4>
                    <p>ANN achieved 86.6% accuracy with 2,945 parameters. The model shows good generalization with minimal overfitting between training and validation.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Chart configuration and data
        Chart.defaults.font.family = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
        Chart.defaults.color = '#374151';

        // Function to generate purple shades based on value
        function getPurpleShade(value, min, max) {
            const normalized = (value - min) / (max - min);
            const hue = 270; // Base purple hue
            const saturation = 60 + normalized * 20; // 60% to 80%
            const lightness = 70 - normalized * 30; // 70% to 40%
            return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
        }

        function getPurpleShadeWithAlpha(value, min, max, alpha) {
            const normalized = (value - min) / (max - min);
            const hue = 270;
            const saturation = 60 + normalized * 20;
            const lightness = 70 - normalized * 30;
            return `hsla(${hue}, ${saturation}%, ${lightness}%, ${alpha})`;
        }

        // Geography Chart
        const geographyData = [32.4, 16.8, 16.2];
        const geographyMin = Math.min(...geographyData);
        const geographyMax = Math.max(...geographyData);
        const geographyCtx = document.getElementById('geographyChart').getContext('2d');
        window.geographyChart = new Chart(geographyCtx, {
            type: 'doughnut',
            data: {
                labels: ['Germany (32.4%)', 'Spain (16.8%)', 'France (16.2%)'],
                datasets: [{
                    data: geographyData,
                    backgroundColor: geographyData.map(value => getPurpleShade(value, geographyMin, geographyMax)),
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 20,
                            usePointStyle: true
                        }
                    }
                }
            }
        });

        // Age Chart
        const ageRetainedData = [85, 78, 65, 55, 62];
        const ageChurnedData = [15, 22, 35, 45, 38];
        const ageMin = Math.min(...ageRetainedData, ...ageChurnedData);
        const ageMax = Math.max(...ageRetainedData, ...ageChurnedData);
        const ageCtx = document.getElementById('ageChart').getContext('2d');
        window.ageChart = new Chart(ageCtx, {
            type: 'bar',
            data: {
                labels: ['20-30', '30-40', '40-50', '50-60', '60+'],
                datasets: [{
                    label: 'Retained',
                    data: ageRetainedData,
                    backgroundColor: ageRetainedData.map(value => getPurpleShade(value, ageMin, ageMax)),
                    borderRadius: 5
                }, {
                    label: 'Churned',
                    data: ageChurnedData,
                    backgroundColor: ageChurnedData.map(value => getPurpleShadeWithAlpha(value, ageMin, ageMax, 0.7)),
                    borderRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        stacked: true,
                        grid: { display: false }
                    },
                    y: {
                        stacked: true,
                        grid: { color: '#f1f5f9' }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20
                        }
                    }
                }
            }
        });

        // ANN Architecture Chart
        const annNeuronsData = [12, 64, 32, 1];
        const annParamsData = [0, 832, 2080, 33];
        const annMin = Math.min(...annNeuronsData, ...annParamsData);
        const annMax = Math.max(...annNeuronsData, ...annParamsData);
        const annCtx = document.getElementById('annChart').getContext('2d');
        new Chart(annCtx, {
            type: 'bar',
            data: {
                labels: ['Input Layer', 'Hidden Layer 1', 'Hidden Layer 2', 'Output Layer'],
                datasets: [{
                    label: 'Neurons',
                    data: annNeuronsData,
                    backgroundColor: annNeuronsData.map(value => getPurpleShade(value, annMin, annMax)),
                    borderRadius: 8,
                    borderWidth: 2,
                    borderColor: annNeuronsData.map(value => getPurpleShadeWithAlpha(value, annMin, annMax, 0.8))
                }, {
                    label: 'Parameters',
                    data: annParamsData,
                    backgroundColor: annParamsData.map(value => getPurpleShadeWithAlpha(value, annMin, annMax, 0.3)),
                    borderRadius: 8,
                    yAxisID: 'y1'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        grid: { color: '#f1f5f9' },
                        title: {
                            display: true,
                            text: 'Neurons'
                        }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        grid: { drawOnChartArea: false },
                        title: {
                            display: true,
                            text: 'Parameters'
                        }
                    },
                    x: {
                        grid: { display: false }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20
                        }
                    }
                }
            }
        });

        // ANN Training Progress Chart
        const trainingData = [82.98, 85.56, 85.59, 85.90, 86.01, 86.09, 86.18, 86.51, 86.50, 86.55, 87.06, 87.04];
        const validationData = [85.30, 85.75, 86.60, 85.85, 85.65, 85.95, 86.55, 85.45, 86.25, 85.90, 85.45, 86.20];
        const perfMin = Math.min(...trainingData, ...validationData);
        const perfMax = Math.max(...trainingData, ...validationData);
        const performanceCtx = document.getElementById('performanceChart').getContext('2d');
        new Chart(performanceCtx, {
            type: 'line',
            data: {
                labels: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20],
                datasets: [{
                    label: 'Training Accuracy',
                    data: trainingData,
                    borderColor: trainingData.map(value => getPurpleShade(value, perfMin, perfMax)),
                    backgroundColor: trainingData.map(value => getPurpleShadeWithAlpha(value, perfMin, perfMax, 0.1)),
                    tension: 0.4,
                    pointRadius: 4,
                    fill: true
                }, {
                    label: 'Validation Accuracy',
                    data: validationData,
                    borderColor: validationData.map(value => getPurpleShadeWithAlpha(value, perfMin, perfMax, 0.7)),
                    backgroundColor: validationData.map(value => getPurpleShadeWithAlpha(value, perfMin, perfMax, 0.1)),
                    tension: 0.4,
                    pointRadius: 4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: false,
                        min: 80,
                        max: 90,
                        grid: { color: '#f1f5f9' },
                        title: {
                            display: true,
                            text: 'Accuracy (%)'
                        }
                    },
                    x: {
                        grid: { display: false },
                        title: {
                            display: true,
                            text: 'Epoch'
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20
                        }
                    }
                }
            }
        });

        // Risk Segmentation Chart
        const riskData = [20, 60, 20];
        const riskMin = Math.min(...riskData);
        const riskMax = Math.max(...riskData);
        const riskCtx = document.getElementById('riskChart').getContext('2d');
        new Chart(riskCtx, {
            type: 'pie',
            data: {
                labels: ['High Risk (20%)', 'Medium Risk (60%)', 'Low Risk (20%)'],
                datasets: [{
                    data: riskData,
                    backgroundColor: riskData.map(value => getPurpleShade(value, riskMin, riskMax)),
                    borderWidth: 0,
                    hoverOffset: 15
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 20,
                            usePointStyle: true
                        }
                    }
                }
            }
        });

        // Product Analysis Chart
        const productData = [27.7, 7.6, 82.7, 100];
        const productMin = Math.min(...productData);
        const productMax = Math.max(...productData);
        const productCtx = document.getElementById('productChart').getContext('2d');
        window.productChart = new Chart(productCtx, {
            type: 'line',
            data: {
                labels: ['1 Product', '2 Products', '3 Products', '4+ Products'],
                datasets: [{
                    label: 'Churn Rate (%)',
                    data: productData,
                    borderColor: getPurpleShade(productMax, productMin, productMax),
                    backgroundColor: getPurpleShadeWithAlpha(productMax, productMin, productMax, 0.1),
                    tension: 0.4,
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        grid: { color: '#f1f5f9' },
                        title: {
                            display: true,
                            text: 'Churn Rate (%)'
                        }
                    },
                    x: {
                        grid: { display: false }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });

        // Global variables for segment filtering
        let currentSegment = 'all';
        let originalChartData = {};

        // Store original data for filtering
        const segmentData = {
            all: {
                geography: [32.4, 16.8, 16.2],
                age: { retained: [85, 78, 65, 55, 62], churned: [15, 22, 35, 45, 38] },
                products: [27.7, 7.6, 82.7, 100]
            },
            high: {
                geography: [45.2, 28.1, 26.7], // Higher risk in Germany
                age: { retained: [45, 52, 35, 25, 38], churned: [55, 48, 65, 75, 62] },
                products: [45.3, 15.2, 89.1, 100]
            },
            medium: {
                geography: [28.5, 18.2, 15.8],
                age: { retained: [78, 70, 58, 48, 55], churned: [22, 30, 42, 52, 45] },
                products: [22.1, 8.9, 78.4, 95.2]
            },
            low: {
                geography: [12.1, 8.4, 7.9],
                age: { retained: [92, 88, 82, 78, 80], churned: [8, 12, 18, 22, 20] },
                products: [12.3, 3.2, 45.6, 78.9]
            }
        };

        // Segment selector functionality
        function setActiveSegment(segment) {
            currentSegment = segment;
            
            // Update button states
            document.querySelectorAll('.segment-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[onclick="setActiveSegment('${segment}')"]`).classList.add('active');
            
            // Update charts with new data
            updateChartsForSegment(segment);
            
            // Add animation effect
            document.querySelectorAll('.chart-card').forEach(card => {
                card.style.transform = 'scale(0.95)';
                card.style.opacity = '0.7';
                setTimeout(() => {
                    card.style.transform = 'scale(1)';
                    card.style.opacity = '1';
                }, 200);
            });
        }

        // Function to update charts based on selected segment
        function updateChartsForSegment(segment) {
            const data = segmentData[segment];
            
            // Update Geography Chart
            const geoMin = Math.min(...data.geography);
            const geoMax = Math.max(...data.geography);
            window.geographyChart.data.datasets[0].data = data.geography;
            window.geographyChart.data.datasets[0].backgroundColor = data.geography.map(value => getPurpleShade(value, geoMin, geoMax));
            window.geographyChart.update('active');
            
            // Update Age Chart
            const ageSegmentMin = Math.min(...data.age.retained, ...data.age.churned);
            const ageSegmentMax = Math.max(...data.age.retained, ...data.age.churned);
            window.ageChart.data.datasets[0].data = data.age.retained;
            window.ageChart.data.datasets[0].backgroundColor = data.age.retained.map(value => getPurpleShade(value, ageSegmentMin, ageSegmentMax));
            window.ageChart.data.datasets[1].data = data.age.churned;
            window.ageChart.data.datasets[1].backgroundColor = data.age.churned.map(value => getPurpleShadeWithAlpha(value, ageSegmentMin, ageSegmentMax, 0.7));
            window.ageChart.update('active');
            
            // Update Product Chart
            const prodMin = Math.min(...data.products);
            const prodMax = Math.max(...data.products);
            window.productChart.data.datasets[0].data = data.products;
            window.productChart.data.datasets[0].borderColor = getPurpleShade(prodMax, prodMin, prodMax);
            window.productChart.data.datasets[0].backgroundColor = getPurpleShadeWithAlpha(prodMax, prodMin, prodMax, 0.1);
            window.productChart.update('active');
        }

        // Add entrance animations
        setTimeout(() => {
            document.querySelectorAll('.kpi-card').forEach((card, index) => {
                setTimeout(() => {
                    card.classList.add('pulse');
                    setTimeout(() => {
                        card.classList.remove('pulse');
                    }, 1000);
                }, index * 200);
            });
        }, 1000);

        // Update timestamp
        setInterval(() => {
            const now = new Date();
            const timestamp = now.toLocaleString();
            // Could add a timestamp element if needed
        }, 1000);
    </script>
</body>
</html>